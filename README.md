# WorkforceCalc (HRPlan) for Obsidian

WorkforceCalc は Obsidian 内で直感的に要員計画（リソース・アロケーション）を管理するためのカスタムプラグインです。
「プレーンテキストのポータビリティ」という Obsidian の思想を守るため、`.hrplan` というハイブリッド拡張子（YAML Frontmatter + CSV）を採用しています。
柔軟なUI操作と、AI（LLM）からの読み書きのしやすさを両立した設計になっています。

## ✨ 主な機能

* **ピボットテーブル形式の直接編集**:
  「メンバー＞テーマ」「テーマ＞メンバー」の2つのビューを切り替えながら、月別の工数（MMなど）を直接セルに入力・編集できます。
* **折りたたみ（アコーディオン）UI**:
  メンバごと、テーマごとの行を折りたたんで小計のみをスッキリと見せることができます。また、「期間(月)」の列をまとめて非表示にし、合計だけを表示する機能も搭載しています。
* **インラインでのマスタ管理**:
  「マスタ設定」タブから、メンバやテーマの追加、変更、削除が可能です。名前を変更した場合は、自動的に割り当てデータ（CSV）側も追従して更新されます。
* **AIフレンドリーなデータ構造 (`.hrplan`)**:
  計算後の「メンバ別月別小計」や「テーマ別月別小計」は、CSVではなく YAML Frontmatter に自動的に書き出されます。これにより、LLMや別スクリプトがデータを集計・分析しやすくなっています。
* **ソースビューの直接編集**:
  UIから `ソース表示` タブに切り替えると、裏側の YAML + CSV データそのものをテキストで直接編集・保存することが可能です。

## 🚀 使い方

1. コマンドパレット（`Ctrl+P` または `Cmd+P`）を開きます。
2. **「新しい要員計画 (.hrplan) を作成」** を実行します。
3. 作成された表に対して、数値を入力したり、マスタ設定からメンバやテーマを追加して運用します。

## 📂 `.hrplan` フォーマットの例

データはクリーンでバージョン管理しやすい形で保存されます。設定や小計は Frontmatter に、純粋なアロケーションマトリクスは CSV ボディに格納されています。

```yaml
---
period: "2026/4-2027/3"
months:
  - 2026/4
  - 2026/5
themes:
  - name: プロジェクトA
    description: "新規開発"
members:
  - name: 開発太郎
    description: "リーダー"
    price: 1500
memberTotals:
  開発太郎:
    "2026/4": 0.5
    "2026/5": 1
themeTotals:
  プロジェクトA:
    "2026/4": 0.5
    "2026/5": 1
---
"Member","Theme","2026/4","2026/5"
"開発太郎","プロジェクトA",0.5,1
```
